# Bonded Lsds

:::{note}
The below documentation only focuses on the high-level contents of wrapped LSDs. For more details, please send us a message via Twitter or on-chain (TODO)!
:::

Cavern Protocol accepts Liquid Staking Derivates (LSDs) as collateral. Any user can deposit a hand-picked selection of LSDs on the platform and borrow stable funds against it. Because of the nature of the protocol ([and the rules described here](README.md)), a part of the yield generated by the LSDs will be used to make the protocol function normally. 


:::{note}
LSD tokens are used as collateral to borrow Terra stablecoins from Cavern. Learn more about creating loan positions [here](../money-market/README.md).
:::

## Concepts

#### Shared Slashing Risk

LSD tokens equally share all losses from slashing events of whitelisted validators. Slashing events decrease the LSD exchange rate, lowering the calculated value of a LSD token. When one validator in the LSD validator set undergoes a slashing event, the token will loose in value, resulting in less collateral deposited in the protocol. 


### Extracting the yield

Cavern works by bootstraping yield-baring collaterals and use the yield they generate to make the money market more efficient. In order to allow that, a mecanism has to be put in place to extract the right amount of yield from the collateral. In the case of aLuna, the Cavern protocol creates an asset that is 1:1 pegged to luna (except for slashing events) and the staking yield is directly used in the protocol.

In the case of LSDs, the tokens themselves are yield bearing and auto-compounded. In order to extract the yield from those tokens, a new mechanism has been built that regularly extracts the yield and redirects it into the protocol. 

### Wrapping the LSD

To extract that yield, Cavern chose to wrap any accepted LSD token into a CW20 compliant token that includes decompounding functions. Those functions are called regularly to make sure the Wrapped token stays at a $1:1$ ratio with the underlying asset (`luna` in most cases), sending surplus LSD tokens to the protocol for rewarding borrowers and depositors. 

Here is a detailed step-by-step explanation of this mecanism on an example. We will call the LSD [`steak`](https://github.com/steak-enjoyers/steak). Its underlying asset will be `luna`. 

1. Alice deposits $100$ `steak` in the platform. At the time of deposit, let's imagine those $100$ `steaks` are worth $2$ `luna` each. The steak tokens get wrapped into a `w-steak` token (this part is transparent to the every-day user) and deposited into the custody contract that is responsible for safe-keeping the collaterals. 

2. Alice can borrow some funds against this $100$ `steak` collateral. The value of this steak collateral is the value of $100 * 2 = 200$ `luna`. 

3. As time passes, the `steak` rewards are decompounded. For intance, if the exchange rate of `steak` goes up to $3$ `luna` per `steak`, the total value that Alice had deposited in the beginning becomes $300$ `luna`. In order to keep a $1:1$ exchange rate with the underlying asset, the protocol will decompound $100$ `luna` worth of steak and distribute it to the protocol depositors and borrowers. Alice now still has a $200$ `luna` value, meaning that her balance sheet contains only $200 / 3 = 66,7$ `steak`

4. If Alice chooses to withdraw now, she will get those $66,7$ `steak` back on her account, without needing to unwrap tokens. The WebApp takes care of all the wrapping and unwrapping of collaterals automatically. 


You may understand with this little example that when depositing your LSD to borrow stable funds, your total number of LSD tokens will decrease with time whereas the value in underlying asset units will not change.  

### Closing remark

This mechanism doesn't account for differences in yield brought by different assets. 

We are working on a way of extracting a maximum amount of yield so that different yield and collateral strategies may be included in the protocol without giving up all the yield a more lucrative asset may bring
